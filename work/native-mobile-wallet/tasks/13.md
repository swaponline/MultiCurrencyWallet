---
status: planned
depends_on: [6]
wave: 7
skills: ["code-writing"]
verify: bash
reviewers: ["code-reviewer", "infrastructure-reviewer"]
---

# Task 13: Settings, White-label, Crashlytics

## Required Skills

Before starting, load:
- `/skill:code-writing` — [~/.claude/skills/code-writing/SKILL.md](~/.claude/skills/code-writing/SKILL.md)

## Description

Implement Settings screen (custom RPC URLs with HTTPS/private-IP validation, network selector), white-label support (parameterized app name/applicationId), and Firebase Crashlytics with secret-safe logging policy.

## What to do

1. Create SettingsScreen with: RPC URLs config, network selector, backup wallet button
2. Implement custom RPC URL input: validate HTTPS only, block private IPs, warn user
3. Implement network selector: Mainnet / Testnet (requires app restart)
4. Implement backup wallet flow: show mnemonic (FLAG_SECURE), confirm user wrote it down
5. Configure white-label: buildConfigField for APP_NAME, parameterized applicationId in build.gradle
6. Integrate Firebase Crashlytics: add dependency, configure in build.gradle
7. Implement secret-safe logging: custom Timber tree that filters private keys, mnemonics, passwords from logs
8. Add Crashlytics custom logs for tx lifecycle: only tx hash, status, chain (no amounts, addresses, signing data)
9. Strip DEBUG-level logs in release builds
10. Write unit tests for RPC URL validation

## TDD Anchor

tests/13_test.kt:
- testRpcUrlValidationHttps — https://example.com → valid
- testRpcUrlValidationHttp — http://example.com → rejected
- testRpcUrlValidationPrivateIp — https://192.168.1.1 → rejected
- testCrashlyticsLogging — log tx event → verify no sensitive data in log

## Acceptance Criteria

- [ ] All unit tests pass
- [ ] Implementation matches tech-spec requirements
- [ ] No security vulnerabilities introduced
- [ ] Code follows Android best practices

## Context Files

- [user-spec.md](../user-spec.md)
- [tech-spec.md](../tech-spec.md)
- [src/front/config/mainnet/evmNetworks.js](../../src/front/config/mainnet/evmNetworks.js)
- [src/front/externalConfigs/mainnet-default.js](../../src/front/externalConfigs/mainnet-default.js)

## Verification Steps

1. Run: `cd android && ./gradlew test`
2. Expected: All tests pass
3. Verify implementation matches requirements from tech-spec

## Details

See tech-spec for complete implementation details for this task.

## Reviewers

- **code-reviewer** → `logs/working/task-13/code-reviewer-{round}.json`
- **infrastructure-reviewer** → `logs/working/task-13/infrastructure-reviewer-{round}.json`

## Post-completion

- [ ] Write report to decisions.md (include all review rounds with links)
- [ ] If deviated from spec — describe deviation and reason
- [ ] Update user-spec/tech-spec if anything changed
