---
status: planned
depends_on: [4]
wave: 5
skills: ["code-writing"]
verify: bash
reviewers: ["code-reviewer", "test-reviewer"]
---

# Task 8: Wallet UI + Navigation

## Required Skills

Before starting, load:
- `/skill:code-writing` — [~/.claude/skills/code-writing/SKILL.md](~/.claude/skills/code-writing/SKILL.md)

## Description

Implement Compose single-activity architecture with bottom navigation (Wallet / dApps tabs), onboarding flows (create/import with seed confirmation retry), balance list with pull-to-refresh, offline mode state, and complete Navigation graph with stub screens for Send, History, Settings, dApp Browser. FLAG_SECURE on mnemonic/seed screens.

## What to do

1. Create MainActivity with @AndroidEntryPoint, setContent { WalletApp() }
2. Create WalletApp() composable with NavHost and BottomNavigation
3. Implement OnboardingScreen: Create Wallet / Import Wallet buttons
4. Implement CreateWalletScreen: show 12 words, "I wrote it down" button
5. Implement SeedConfirmationScreen: prompt for 3 random words, retry on error (up to 3 attempts, then reset), FLAG_SECURE
6. Implement SetPasswordScreen: password input (8+ chars), confirmation
7. Implement WalletScreen: balance list (BTC, ETH, BNB, MATIC), pull-to-refresh, offline mode banner
8. Implement bottom navigation: Wallet tab, dApps tab
9. Create stub screens: SendScreen, HistoryScreen, SettingsScreen, DAppBrowserScreen
10. Create WalletViewModel: manage balances StateFlow, handle refresh
11. Set FLAG_SECURE on mnemonic display and seed confirmation screens
12. Write unit tests for OnboardingViewModel (seed confirmation retry logic)

## TDD Anchor

tests/8_test.kt:
- testSeedConfirmationRetry — wrong words → retry (up to 3 attempts)
- testSeedConfirmationReset — 3 failures → show all 12 words again, reset counter
- testPasswordValidation — 8+ chars → valid, 7 chars → error
- testBalanceRefresh — pull-to-refresh triggers new API call
- testOfflineModeState — API error → show error banner, disable Send button

## Acceptance Criteria

- [ ] All unit tests pass
- [ ] Implementation matches tech-spec requirements
- [ ] No security vulnerabilities introduced
- [ ] Code follows Android best practices

## Context Files

- [user-spec.md](../user-spec.md)
- [tech-spec.md](../tech-spec.md)

## Verification Steps

1. Run: `cd android && ./gradlew test`
2. Expected: All tests pass
3. Verify implementation matches requirements from tech-spec

## Details

See tech-spec for complete implementation details for this task.

## Reviewers

- **code-reviewer** → `logs/working/task-8/code-reviewer-{round}.json`
- **test-reviewer** → `logs/working/task-8/test-reviewer-{round}.json`

## Post-completion

- [ ] Write report to decisions.md (include all review rounds with links)
- [ ] If deviated from spec — describe deviation and reason
- [ ] Update user-spec/tech-spec if anything changed
