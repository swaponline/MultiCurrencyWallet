!function(){var e="WALLET_APPS_BRIDGE_HELLO";if("undefined"!=typeof window&&window.parent!==window){var n={},r={},t=0,a="*",i=!1,o=[],d=null,s=function(e,r){n[e]&&n[e].forEach(function(e){try{e(r)}catch(e){console.error("[WalletAppsBridge] listener failed",e)}})},u=function(e,n){window.parent.postMessage({source:"swap.wallet.apps.bridge.client",type:e,payload:n},a)},c=function(e){return new Promise(function(n,a){var i=e&&e.method;if(i){var o="wab-"+Date.now()+"-"+ ++t;r[o]={resolve:n,reject:a},u("WALLET_APPS_BRIDGE_REQUEST",{requestId:o,method:i,params:e.params}),setTimeout(function(){r[o]&&(delete r[o],a(new Error("WalletAppsBridge timeout")))},3e4)}else a(new Error("WalletAppsBridge request requires method"))})},l={isSwapWalletAppsBridge:!0,isMetaMask:!0,chainId:null,selectedAddress:null,request:c,enable:function(){return c({method:"eth_requestAccounts"})},isConnected:function(){return!!i},on:function(e,r){return n[e]||(n[e]=[]),n[e].push(r),l},removeListener:function(e,r){return n[e]?(n[e]=n[e].filter(function(e){return e!==r}),l):l},removeAllListeners:function(e){return e?n[e]=[]:n={},l},send:function(e,n){return c("string"==typeof e?{method:e,params:n}:e)},sendAsync:function(e,n){c(e).then(function(r){"function"==typeof n&&n(null,{id:e&&e.id?e.id:Date.now(),jsonrpc:"2.0",result:r})}).catch(function(e){"function"==typeof n&&n(e)})}};window.addEventListener("message",function(e){if(e.source===window.parent){var n=e.data||{};if("swap.wallet.apps.bridge.host"===n.source){if(a=e.origin||"*","WALLET_APPS_BRIDGE_READY"===n.type){i=!0;var t=n.payload||{};return d=t.chainId||null,o=Array.isArray(t.accounts)?t.accounts:[],l.chainId=d,l.selectedAddress=o[0]||null,s("bridgeReady",t),s("connect",{chainId:d}),d&&s("chainChanged",d),void(o.length&&s("accountsChanged",o))}if("WALLET_APPS_BRIDGE_RESPONSE"!==n.type){if("WALLET_APPS_BRIDGE_EVENT"===n.type){var u=n.payload||{};u.eventName&&("chainChanged"===u.eventName&&(d=u.data||null,l.chainId=d),"accountsChanged"===u.eventName&&(o=Array.isArray(u.data)?u.data:[],l.selectedAddress=o[0]||null,o.length||s("disconnect",{code:4900,message:"Wallet disconnected"})),s(u.eventName,u.data))}}else{var c=n.payload||{},w=c.requestId;if(!w||!r[w])return;var p=r[w];if(delete r[w],c.error){var f=new Error(c.error.message||"WalletAppsBridge request failed");f.code=c.error.code,p.reject(f)}else p.resolve(c.result)}}}});var w=0,p=setInterval(function(){i||w>20?clearInterval(p):(w+=1,u(e,{version:"1.0.0",ua:navigator.userAgent}))},750);u(e,{version:"1.0.0",ua:navigator.userAgent}),function(){var e=window.location.search.indexOf("walletBridge=swaponline")>=0;if(!window.ethereum||e)try{Object.defineProperty(window,"ethereum",{configurable:!0,enumerable:!0,writable:!0,value:l})}catch(e){window.ethereum=l}window.swapWalletAppsBridgeProvider=l,window.ethereum.providers||(window.ethereum.providers=[window.ethereum]),window.dispatchEvent(new Event("ethereum#initialized"))}()}}();